<!doctype html>
<html lang="th"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>JUST COM — หลังบ้าน</title>
<style>body{font-family:ui-sans-serif,system-ui,'Noto Sans Thai',sans-serif;margin:0;background:#0f1114;color:#eaf0f7}.wrap{max-width:1100px;margin:0 auto;padding:18px}.card{background:#151a1f;border:1px solid #222a33;border-radius:14px;padding:14px;margin-bottom:16px}a{color:#7dd3fc}table{width:100%;border-collapse:collapse;margin-top:12px}th,td{border:1px solid #222a33;padding:8px;text-align:left}th{background:#0d1013}code{background:#0d1013;padding:2px 6px;border-radius:8px}</style></head>
<body><div class="wrap"><h1>JUST COM — หลังบ้าน (อ่านข้อมูล)</h1>
<div class="card"><h3>วิธีแก้ไขสินค้า</h3><ol>
<li>เปิดไฟล์ <code>data/justcom_inventory.csv</code> ด้วย Excel / Google Sheets</li>
<li>แก้ไขข้อมูล (เพิ่ม/ลบ/ปรับราคา/สถานะ)</li>
<li>บันทึกไฟล์ (หรือใช้ Google Sheets → <b>Publish to web → CSV</b> แล้วคัดลอก URL มาใส่ใน <code>CONFIG.gsheetCsvUrl</code> และตั้ง <code>CONFIG.mode="gsheet"</code> ที่ไฟล์ <code>index.html</code>)</li>
<li>Commit + Push → หน้าเว็บจะอัปเดตอัตโนมัติ</li></ol>
<p>คอลัมน์ที่รองรับ: <code>ชื่อสินค้า</code>, <code>ยี่ห้อ/แบรนด์</code>, <code>รุ่นย่อย</code>, <code>หมวดหมู่</code>, <code>ราคา (THB)</code>, <code>จำนวนคงเหลือ</code>, <code>สถานะประกาศ (active|hidden|sold)</code>, <code>ลิงก์รูปภาพหลัก</code>, <code>ลิงก์รูปภาพเพิ่มเติม (คั่นด้วย ,)</code>, <code>รายละเอียดเพิ่มเติม</code>, <code>รับประกัน (วัน)</code>, <code>วันที่รับของ (YYYY-MM-DD)</code>, <code>อัปเดตล่าสุด (YYYY-MM-DD HH:MM)</code>, <code>แท็ก (คั่นด้วย ,)</code>, <code>SKU</code></p></div>
<div class="card"><h3>พรีวิวข้อมูลล่าสุดจาก CSV</h3><div id="status">กำลังโหลด...</div><div style="overflow:auto"><table id="tbl"></table></div></div>
</div>
<script>
const CSV_URL="../data/justcom_inventory.csv";
function csvToArray(str,delim=","){const rows=str.split("\n").filter(x=>x.trim().length);if(!rows.length)return[];const headers=rows.shift().split(delim).map(h=>h.trim());return rows.map(row=>{const cols=[];let cur="",inQ=false;for(let i=0;i<row.length;i++){const c=row[i];if(c=='"'){inQ=!inQ;}else if(c===delim && !inQ){cols.push(cur);cur="";}else{cur+=c;}}cols.push(cur);const obj={};headers.forEach((h,i)=>obj[h]=(cols[i]??"").trim());return obj;});}
async function boot(){const res=await fetch(CSV_URL+"?v="+Date.now());const text=await res.text();const rows=csvToArray(text);document.getElementById("status").textContent="รายการทั้งหมด "+rows.length+" ชิ้น";const tbl=document.getElementById("tbl");if(!rows.length){tbl.innerHTML="<tr><td>ไม่พบข้อมูล</td></tr>";return;}const headers=Object.keys(rows[0]);tbl.innerHTML="<thead><tr>"+headers.map(h=>"<th>"+h+"</th>").join("")+"</tr></thead>";tbl.innerHTML+="<tbody>"+rows.map(r=>"<tr>"+headers.map(h=>"<td>"+(r[h]||"")+"</td>").join("")+"</tr>").join("")+"</tbody>";}
boot();
</script>
</body></html>